<div class="buyNowPanel col-md-12 d-flex flex-row flex-wrap">
  <h2 class="col-12">You can buy this vehicle online now</h2>
  <p class="col-12">This is the quickest way to get you driving the vehicle of your dreams. We'll prepare all
    of the paperwork for you ahead of time. We'll also wash your car and have it ready to sign and drive when
    you arrive. We'll drop you an email when it's ready to be picked up. Be sure to bring your id and proof of
    insurance with you.</p>
  <p class="col-12">Want to test drive it first? You can take it for a spin when you get here. Even better,
    choose the platinum package below to ensure that this high quality vehicle is covered for any major
    repairs for the next 7 years giving you peace of mind both now and for the life of your vehicle.
  </p>
  <h3 class="col-12 mt-3">Step 1: Choose A Protection Package</h3>
  <div class="col-md-6 col-xl-8">
    <h5 *ngIf="installmentLabel != 'Monthly'">{{ car.selectedPlan }} {{ installmentLabel }} {{ calculatePayment(car,
      selectedPeriod) | currency }}</h5>
    <h5>{{ car.selectedPlan }} Monthly {{ calculatePayment(car, 3) | currency }}</h5>
  </div>
  <div class="col-md-6 col-xl-4 text-right buttons d-flex flex-row text-right justify-content-between align-items-end">
    <button class="btn btn-default bronze" [class.zoom]="car.selectedPlan == 'Bronze'" (click)="car.selectedPlan = 'Bronze'">Bronze</button>
    <button class="btn btn-default silver" [class.zoom]="car.selectedPlan == 'Silver'" (click)="car.selectedPlan = 'Silver'">Silver</button>
    <button class="btn btn-default gold" [class.zoom]="car.selectedPlan == 'Gold'" (click)="car.selectedPlan = 'Gold'">Gold</button>
    <button class="btn btn-default platinum" [class.zoom]="car.selectedPlan == 'Platinum'" (click)="car.selectedPlan = 'Platinum'">Platinum</button>
  </div>
  <div class="coverage col-12 border d-flex flex-row flex-wrap" *ngFor="let key of coverages">
    <div class="col-md-6 col-xl-8 pointer" (click)="toggleDetail(key)">
      <span [class.strike]="!planPricing[car.selectedPlan][key]">{{ planPricing['Platinum'][key].description }}
        (+{{ planPricing['Platinum'][key][installmentKey] | currency }} {{ installmentKey }})
        <i *ngIf="planPricing['Platinum'][key].expanded" class="fas fa-chevron-circle-up yellow"></i>
        <i *ngIf="!planPricing['Platinum'][key].expanded" class="fas fa-chevron-circle-down yellow"></i>
      </span>
    </div>
    <div class="col-md-6 col-xl-4 border d-flex flex-row text-right justify-content-between">
      <i class="fa-2x" [ngClass]="planPricing['Bronze'][key] ? 'fas fa-check' : 'fas fa-times'"></i>
      <i class="fa-2x" [ngClass]="planPricing['Silver'][key] ? 'fas fa-check' : 'fas fa-times'"></i>
      <i class="fa-2x" [ngClass]="planPricing['Gold'][key] ? 'fas fa-check' : 'fas fa-times'"></i>
      <i class="fa-2x" [ngClass]="planPricing['Platinum'][key] ? 'fas fa-check' : 'fas fa-times'"></i>
    </div>
    <div *ngIf="planPricing['Platinum'][key].expanded" class="col-md-6 col-xl-8 pl-5 pb-4" [innerHtml]="planPricing['Platinum'][key].detail">
    </div>
  </div>
  <form #jumboForm="ngForm" class="form-horizontal d-flex flex-row align-items-center justify-content-start flex-wrap">
    <h3 class="col-12 mt-3">Step 2: Enter Your Contact Information</h3>
    <div class="col-12 col-md-4">
      <div class="form-group" [class.has-danger]="firstName.touched && firstName.invalid" [class.has-success]="firstName.valid">
        <input type="text" #firstName="ngModel" name="firstName" placeholder="{{ 'Your First Name' | translate }}"
          pattern="\w{2,}\s+\w{2,}" [(ngModel)]="model.firstName" class="form-control" required />
        <span *ngIf="firstName.touched && firstName.invalid" class="text-danger">Enter your first name</span>
      </div>
      <div class="form-group" [class.has-danger]="lastName.touched && lastName.invalid" [class.has-success]="lastName.valid">
        <input type="text" #lastName="ngModel" name="lastName" placeholder="{{ 'Your Last Name' | translate }}" pattern="\w{2,}\s+\w{2,}"
          [(ngModel)]="model.lastName" class="form-control" required />
        <span *ngIf="lastName.touched && lastName.invalid" class="text-danger">Enter your last name</span>
      </div>
      <div class="form-group" [class.has-danger]="email.touched && email.invalid" [class.has-success]="email.valid">
        <input type="email" #email="ngModel" name="email" placeholder="{{ 'Email' | translate }}" pattern='^[^ @]+@[^ @]+\.[^ \.@]{2,5}$'
          [(ngModel)]="model.email" class="form-control" required />
      </div>
      <div class="form-group" [class.has-danger]="phone.touched && phone.invalid" [class.has-success]="phone.valid">
        <input type="phone" #phone="ngModel" name="phone" placeholder="{{ 'Phone Number' | translate }}" pattern="^\(?\d{3}[\)-\s\.]*\d{3}[-\s\.]*\d{4}$"
          [(ngModel)]="model.phone" class="form-control" required />
      </div>
    </div>
    <div class="col-12 col-md-4">
      <div class="form-group" [class.has-danger]="address.touched && address.invalid" [class.has-success]="address.valid">
        <input type="text" #address="ngModel" name="address" placeholder="{{ 'Address' | translate }}" pattern="\w{2,}\s+\w{2,}"
          [(ngModel)]="model.address" class="form-control" required />
        <span *ngIf="address.touched && address.invalid" class="text-danger">Enter your street address</span>
      </div>
      <div class="form-group" [class.has-danger]="city.touched && city.invalid" [class.has-success]="city.valid">
        <input type="text" #city="ngModel" name="city" placeholder="{{ 'City' | translate }}" pattern="\w{2,}\s+\w{2,}"
          [(ngModel)]="model.city" class="form-control" required />
        <span *ngIf="city.touched && city.invalid" class="text-danger">Enter your city</span>
      </div>
      <div class="form-group" [class.has-danger]="state.touched && state.invalid" [class.has-success]="state.valid">
        <input type="text" #state="ngModel" name="state" placeholder="{{ 'State' | translate }}" pattern="\w{2,}\s+\w{2,}"
          [(ngModel)]="model.state" class="form-control" required />
        <span *ngIf="state.touched && state.invalid" class="text-danger">Enter your state</span>
      </div>
      <div class="form-group" [class.has-danger]="zipcode.touched && zipcode.invalid" [class.has-success]="zipcode.valid">
        <input type="text" #zipcode="ngModel" name="name" placeholder="{{ 'Zip Code' | translate }}" pattern="\w{2,}\s+\w{2,}"
          [(ngModel)]="model.zipcode" class="form-control" required />
        <span *ngIf="zipcode.touched && zipcode.invalid" class="text-danger">Enter your zipcode</span>
      </div>
    </div>
    <div class="col-12 col-md-4">
      Be sure to enter this information accurately. We need to be able to contact you in order
      to inform you that we've finished preparing your new vehicle. We'll also need to make
      sure that your identification matches this information when you pick up your vehicle.
    </div>
    <h3 class="col-12 mt-3">Step 3: Vehicle Trade-in</h3>
    <div class="col-12 col-md-6">
      <div class="form-group" [class.has-danger]="firstName.touched && firstName.invalid" [class.has-success]="firstName.valid">
        <label>Do you have a vehicle to trade-in?</label>
        <div class="btn-group">
          <label class="btn btn-primary" (click)="model.willTradeIn = true"><i [class]="model.willTradeIn ? 'fas fa-check' : 'far fa-square'"></i>
            Yes</label>
          <label class="btn btn-primary" (click)="model.willTradeIn = false"><i [class]="!model.willTradeIn ? 'fas fa-check' : 'far fa-square'"></i>
            No</label>
        </div>
      </div>
    </div>

  </form>
  <div class="col-12 d-flex flex-row align-items-end justify-content-end">
    <button class="btn btn-secondary text-center m-2" (click)="back.emit()"><i class="fas fa-chevron-left"></i> Back</button>
    <button *ngIf="!model.willTradeIn" class="btn btn-2x btn-success text-center m-2" (click)="checkout.emit()">Checkout <i class="fas fa-chevron-right"></i></button>
    <div *ngIf="model.willTradeIn" class="btn btn-warning col-md-6 m-2 col-xl-4 d-flex flex-row flex-wrap text-wrap align-items-end justify-content-end" (click)="tradein()">
        <svg id="Layer_1" class="col-md-6" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 557 187">
          <defs>
            <style>
              .cls-1 {
                fill: white;
              }
            </style>
          </defs>
          <title>max-allowance-logo</title>
          <path d="M232,124l8,63H225V176h-8v11H201l9-63Zm-9,41-3-26-3,26Z" transform="translate(-1)" />
          <path d="M279,124v63H263V124Z" transform="translate(-1)" />
          <path d="M259,124v63H243V124Z" transform="translate(-1)" />
          <path d="M301,135c-16,0-18,8-18,18v16c0,9,1,18,18,18s18-9,18-18V153C319,144,318,135,301,135Zm-3,37V150q0-6,3-6c2,0,3,1,3,6v23c0,4-1,5-3,5s-3-1-3-5Z"
            transform="translate(-1)" />
          <path d="M376,135l-8,52H351l-4-25-4,25H326l-7-52h14l4,29,4-29h13l4,29,4-29Z" transform="translate(-1)" />
          <path class="cls-1" d="M182,124H166l-4,19-3-19H144l6,29-7,27-7-56H113l-7,49V67L55,97,1,56V187H30V102l13,85H64l13-85v85h41l2-12h9v12h28l4-24,4,24h15l-7-34Zm-61,41,4-26,3,26"
            transform="translate(-1)" />
          <polygon points="53 82 143 0 158 18 53 118 0 56 17 40 53 82" />
          <path d="M539,132h-3v-3h9v3h-3v8h-3Z" transform="translate(-1)" />
          <path d="M546,140V129h3l3,8,3-8h3v11h-3v-6l-2,6h-2l-2-6v6Z" transform="translate(-1)" />
          <path d="M480,166v6q0,6-3,6t-3-6V150q0-6,3-6t3,6v4h14c0-9,0-19-17-19s-18,10-18,19v14c0,9,0,19,18,19s17-12,17-21Z"
            transform="translate(-1)" />
          <path d="M535,153c0-9-2-18-19-18s-17,10-17,19v14c0,9,0,19,18,19s18-13,18-22H521v7c0,4-2,7-4,7s-3-3-3-7V160h21Zm-21-2q0-6,3-6t3,6v3h-6Z"
            transform="translate(-1)" />
          <path d="M454,154c0-4,0-10-3-14a11,11,0,0,0-15.45-1.86A11.22,11.22,0,0,0,433,141v-4H418v50h15V150c0-5,1-6,3-6s3,1,3,6v37h15Z"
            transform="translate(-1)" />
          <path d="M412,187V155c0-9-1-20-17-20s-18,11-18,20h15v-5q0-6,3-6c2,0,3,2,3,5s0,5-1,6-9,4-14,6-7,4-7,13,1,13,11,13,10-5,10-5v5Zm-18-8c-2,0-3-1-3-6s0-7,5-11v11C397,178,396,179,394,179Z"
            transform="translate(-1)" />
        </svg>
        <h5 class="col-md-6">Maximize My<br/>Trade-in <i class="fas fa-chevron-right"></i></h5>
      </div>
    </div>
</div>